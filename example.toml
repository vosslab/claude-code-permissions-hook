[audit]
audit_file = "/tmp/claude-tool-use.json"
# Audit level: off, matched (default), all
# - off: no auditing
# - matched: audit only tool use that hits a rule (allow/deny)
# - all: audit everything including passthrough
audit_level = "matched"
# Dedicated log for commands that matched neither allow nor deny rules.
# Review this file to identify rule gaps and tighten your config.
passthrough_log_file = "/tmp/claude-passthrough.json"

# Reusable variables - reference as ${VAR_NAME} in regex fields.
# Standard env vars like $HOME expand automatically in values.
[variables]
SAFE_CMDS = "cat|echo|grep|head|ls|sort|tail|wc"
NO_CMD_SUB = "`|\\$\\("
HOME_PATH = "^$HOME/projects/"

# Deny rules - checked first (take precedence)
[[deny]]
tool = "Bash"
command_regex = "^rm .*-rf"

[[deny]]
tool = "Read"
file_path_regex = "\\.(env|secret)$"

[[deny]]
tool = "Read"
file_path_regex = ".*\\.\\./.*"

# Allow rules - checked after deny rules
[[allow]]
tool = "Read"
file_path_regex = "${HOME_PATH}"
file_path_exclude_regex = "\\.\\."

[[allow]]
tool = "Write"
file_path_regex = "${HOME_PATH}"
file_path_exclude_regex = "\\.\\."

[[allow]]
tool = "Edit"
file_path_regex = "${HOME_PATH}"
file_path_exclude_regex = "\\.\\."

[[allow]]
tool = "Bash"
command_regex = "^cargo (build|test|check|clippy|fmt|run)"
command_exclude_regex = "${NO_CMD_SUB}"

[[allow]]
tool = "Bash"
command_regex = "^(${SAFE_CMDS})\\b"
command_exclude_regex = "${NO_CMD_SUB}"

[[allow]]
tool = "Task"
subagent_type = "codebase-analyzer"

[[allow]]
tool = "WebFetch"

[[allow]]
tool = "WebSearch"

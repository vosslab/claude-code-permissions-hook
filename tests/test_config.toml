# Test configuration for integration tests
# Paths and patterns are designed to match the test JSON files

[audit]
audit_file = "/tmp/claude-test-audit.json"
audit_level = "off"

# Deny rules - checked first (take precedence)

# Deny path traversal in Read operations
[[deny]]
tool = "Read"
file_path_regex = ".*\\.\\./.*"

# Deny shell injection patterns in Bash (catches &&, |, ;, $() etc.)
[[deny]]
tool = "Bash"
command_regex = ".*(&|;|\\||`|\\$\\().*"

# Deny dangerous rm commands
[[deny]]
tool = "Bash"
command_regex = "^rm .*-rf"

# Deny sensitive file reads
[[deny]]
tool = "Read"
file_path_regex = "\\.(env|secret)$"

# Allow rules - checked after deny rules

# Allow reads within the Dropbox project directory
[[allow]]
tool = "Read"
file_path_regex = "^/Users/korny/Dropbox/prj/.*"
file_path_exclude_regex = "\\.\\."

# Allow safe cargo commands
[[allow]]
tool = "Bash"
command_regex = "^cargo (build|test|check|clippy|fmt|run)"
command_exclude_regex = "&|;|\\||`|\\$\\("

# Allow specific subagent types
[[allow]]
tool = "Task"
subagent_type = "codebase-analyzer"
